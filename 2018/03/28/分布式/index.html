<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>分布式 | WoodKnot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="事务ACID原子性一致性隔离性（隔离级别）1. Read uncommited 2. Read commited（解决脏读，写数据锁行） 3. Repeateable read（解决不可重复读，写数据锁表） 4. Serializable（解决幻读，读写都锁表） 持久性分布式系统问题分布式系统中，数据通常在多个物理节点中保存了多个副本，如何保证这些节点间数 的一致性 原则1. CAP理论：（强）一">
<meta property="og:type" content="article">
<meta property="og:title" content="分布式">
<meta property="og:url" content="https://woodknot.me/2018/03/28/分布式/index.html">
<meta property="og:site_name" content="WoodKnot">
<meta property="og:description" content="事务ACID原子性一致性隔离性（隔离级别）1. Read uncommited 2. Read commited（解决脏读，写数据锁行） 3. Repeateable read（解决不可重复读，写数据锁表） 4. Serializable（解决幻读，读写都锁表） 持久性分布式系统问题分布式系统中，数据通常在多个物理节点中保存了多个副本，如何保证这些节点间数 的一致性 原则1. CAP理论：（强）一">
<meta property="og:updated_time" content="2018-03-28T02:04:47.526Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="分布式">
<meta name="twitter:description" content="事务ACID原子性一致性隔离性（隔离级别）1. Read uncommited 2. Read commited（解决脏读，写数据锁行） 3. Repeateable read（解决不可重复读，写数据锁表） 4. Serializable（解决幻读，读写都锁表） 持久性分布式系统问题分布式系统中，数据通常在多个物理节点中保存了多个副本，如何保证这些节点间数 的一致性 原则1. CAP理论：（强）一">
  
    <link rel="alternate" href="/atom.xml" title="WoodKnot" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/icons.css">
  <link rel="stylesheet" href="/css/theme.css">


</head>



<body>

  <div class="wrapper">


      <div class="sidebar" data-background-color="white" data-active-color="danger">
  <div class="sidebar-wrapper">
    <div class="logo">
      <a href="/" class="simple-text">
          
          <i class="ti-heart-broken"></i> 你是个好人
          
      </a>
    </div>
    <ul class="nav">
        
      <li>
        <a href="/">
            
          <i class="ti-home"></i> <p>首页</p>
            

        </a>
      </li>
        
      <li>
        <a href="/archives">
            
          <i class="ti-archive"></i> <p>归档</p>
            

        </a>
      </li>
        


        
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
    </ul>
      
          <div class="slogon text-center">
          
          <p>
           当然是选择原谅她啊<br/>
          </p>
          
          <p>
           她真的只是去蹭空调<br/>
          </p>
          
          </div>
      

      

    <div class="social">
        
          <a class="btn" href="//github.com" target="_blank"><i class="ti-github"></i> github</a>
        
          <a class="btn" href="//facebook.com" target="_blank"><i class="ti-facebook"></i> facebook</a>
        
          <a class="btn" href="null" target="_blank"><i class="ti-instagram"></i> instagram</a>
        
          <a class="btn" href="null" target="_blank"><i class="ti-tumblr"></i> tumblr</a>
        
    </div>

      
  </div>
</div>


    <div class="main-panel">
        
<nav class="navbar navbar-default hidden-md hidden-lg">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar bar1"></span>
                <span class="icon-bar bar2"></span>
                <span class="icon-bar bar3"></span>
            </button>
            <a class="navbar-brand" href="/">
                
                你是个好人
                
            </a>
        </div>
        <div class="hidden-sm hidden-xs container">
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        
                        <div class="text-center">
                            
                            <p>
                                当然是选择原谅她啊<br/>
                            </p>
                            
                            <p>
                                她真的只是去蹭空调<br/>
                            </p>
                            
                        </div>
                        

                    </li>
                </ul>

            </div>
        </div>
    </div>
</nav>
      <div class="content bg-white">
        <div class="container">
          <div class="row">
            <div class="col-md-8 col-md-offset-2">
              <div class="post-area">
                    <article id="post-分布式" class="blog-post">
    
    

                
  
    <h1 class="" itemprop="name">
      分布式
    </h1>
  



        <span  class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_custom_widget" style="" data-hs-cos-general-type="widget" data-hs-cos-type="custom_widget">
            <div class="blog-post__metadata">
               <img src="/img/avatar.jpg" class="blog-post__metadata__author-img">
             <div>
                 
                 Wood Knot
                 
              <div class="blog-post__metadata__post-info">
                   <div class="blog-post__metadata__read-time">
                         <a href="/2018/03/28/分布式/" class="article-date">
  <time datetime="2018-03-28T02:04:11.000Z" itemprop="datePublished">2018-03-28</time>
</a> |
                   </div>
                    <div class="blog-post__metadata__topics">
                         
                    </div>
              </div>
            </div>
        </div>
        </span>
        <div class="blog-post__resource">
        
               
                    <a href="/2018/03/28/分布式/" target="_blank">
                        <div class="blog-post__image-container" style="background-image: url(/img/demo.jpeg)">
                            <div class="blog-post__image-overlay">
                            </div>
                        </div>
                    </a>

                    
            
        </div>
        

        
            <div class="blog-post__content">
                <h1 id="事务ACID"><a href="#事务ACID" class="headerlink" title="事务ACID"></a>事务ACID</h1><h2 id="原子性"><a href="#原子性" class="headerlink" title="原子性"></a>原子性</h2><h2 id="一致性"><a href="#一致性" class="headerlink" title="一致性"></a>一致性</h2><h2 id="隔离性（隔离级别）"><a href="#隔离性（隔离级别）" class="headerlink" title="隔离性（隔离级别）"></a>隔离性（隔离级别）</h2><pre><code>1. Read uncommited
2. Read commited（解决脏读，写数据锁行）
3. Repeateable read（解决不可重复读，写数据锁表）
4. Serializable（解决幻读，读写都锁表）
</code></pre><h2 id="持久性"><a href="#持久性" class="headerlink" title="持久性"></a>持久性</h2><h1 id="分布式系统"><a href="#分布式系统" class="headerlink" title="分布式系统"></a>分布式系统</h1><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><pre><code>分布式系统中，数据通常在多个物理节点中保存了多个副本，如何保证这些节点间数 的一致性
</code></pre><h2 id="原则"><a href="#原则" class="headerlink" title="原则"></a>原则</h2><pre><code>1. CAP理论：（强）一致性、可用性、分区容错性
2. BASE理论：基本可用、软状态、最终一致性
</code></pre><h1 id="分布式事务"><a href="#分布式事务" class="headerlink" title="分布式事务"></a>分布式事务</h1><pre><code>1. 2PC：协调者和参与者
    a. 准备阶段：
        aa. 协调者向所有参与者节点发起询问，并等待回复
        bb. 参与者节点执行事务操作，并计入redo和undo日志，并响应协调者
        cc. 如果参与者执行成功返回“同意”否则返回“终止”给协调者
    b. 提交阶段
        如果上一步所有参与者返回同意，则发送commit给参与者，否则发送abort（如果超时还没有收到参与者的反馈，也发送abort）。参与者执行相应的操作，并释放事务过程中的锁资源。
2. 3PC
    a. CanCommit
        协调者向参与者发送CanCommit请求，参与者OK就返回yes并进入预备状态，否则返回no。
    b. PreCommit
        如果上一步参与者都返回yes，则协调者发送PreCommit请求给参与者，参与者执行本地事务并计入undo、redo日志，然后返回ack给协调者。如果上一步有参与者返回了no，则协调者发送abort给参与者，参与者终止事务执行（超时仍未收到协调者的请求，也终止）
    c. DoCommit
        协调者收到了所有参与者的ack反馈，则发送doCommit请求给参与者，参与者提交事务，并释放资源。然后返回ack给协调者，协调者完成事务。
        协调者未收到所有参与者的ack反馈，则发送abort请求，参与者根据日志执行回滚操作，然后返回ack给协调者，协调者完成事务。
        如果这一步超时了，参与者仍未收到doCommit请求，则参与者会继续执行commit操作（这有可能导致数据不一致问题的出现）
3. TCC
4. 本地消息表
5. 事务消息（支持事务的消息队列还不多）
6. Paxos算法
</code></pre>
            </div>
        


    
    
<nav class="blog-pagination">
    <div>
  
    </div>
      
    <div>
      <a class="btn btn-default blog-pagination__btn blog-pagination__btn--next" rel="next" href="/2017/05/17/hello-world/">
          <span class="blog-pagination__btn-label">Hello World</span>
          <i class="ti-arrow-right"></i>
      </a>
    </div>
  

</nav>



    

</article>



              </div>

            </div>
          </div>
        </div>

      </div>
        <footer class="footer">
    <div class="container-fluid">
        <nav class="pull-left">
            <ul>
                <li>
                   <a href="http://hexo.io/" target="_blank">Powered by Hexo</a>
                </li>
                <li>
                    &copy; 2018 Wood Knot
                </li>
            </ul>
        </nav>
        <div class="copyright pull-right">
            Made with <i class="ti-heart heart"></i> by <a href="/">GoodMan</a>
        </div>
    </div>
</footer>
    </div>

  </div>

</body>



<script src="/js/jquery-1.10.2.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/prism.js"></script>
<script src="/js/goodman.js"></script>


</html>